
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="REST Web Framework based on Flask">
      
      
      
        <link rel="canonical" href="https://github.com/oddbit-project/pokie/test/pytest/">
      
      
        <link rel="prev" href="../../codegen/codegen/">
      
      
      
      <link rel="icon" href="../../img/pokie_logo_small.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.2.7">
    
    
      
        <title>Using pytest - Pokie</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.046329b4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.85d0ee34.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="amber">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#writing-tests-with-pytest" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Pokie" class="md-header__button md-logo" aria-label="Pokie" data-md-component="logo">
      
  <img src="../../img/pokie_logo_small.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Pokie
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Using pytest
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="amber"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="amber"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/oddbit-project/pokie" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
  </div>
  <div class="md-source__repository">
    OddBit/pokie
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Pokie" class="md-nav__button md-logo" aria-label="Pokie" data-md-component="logo">
      
  <img src="../../img/pokie_logo_small.png" alt="logo">

    </a>
    Pokie
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/oddbit-project/pokie" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
  </div>
  <div class="md-source__repository">
    OddBit/pokie
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Introduction
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/architecture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Architecture
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/scaffolding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scaffolding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tutorial
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Views
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Views
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../http/views/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pokie Views
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../http/rest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    REST Views
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../http/error_handler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Error Handlers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../http/extending_views/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Extending Views
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    REST Operations
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            REST Operations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../http/rest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    REST Views
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../rest/services/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    REST Services
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../rest/auto/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Auto REST
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Fixtures
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Fixtures
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../fixtures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Adding fixtures
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Classes
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Classes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../http/dbgridrequest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DbGridRequest
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../http/json_response/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JSONResponse
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Cli Operations
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Cli Operations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/commands/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Available Commands
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Code Generation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Code Generation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../codegen/codegen/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code Generation
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" checked>
        
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Writing Tests
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Writing Tests
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Using pytest
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Using pytest
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pokie-configuration" class="md-nav__link">
    Pokie Configuration
  </a>
  
    <nav class="md-nav" aria-label="Pokie Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#application-lifecycle-parameters" class="md-nav__link">
    Application lifecycle parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#database-management" class="md-nav__link">
    Database management
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#available-fixtures" class="md-nav__link">
    Available fixtures
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#writing-tests" class="md-nav__link">
    Writing Tests
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-tox" class="md-nav__link">
    Using tox
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pokie-configuration" class="md-nav__link">
    Pokie Configuration
  </a>
  
    <nav class="md-nav" aria-label="Pokie Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#application-lifecycle-parameters" class="md-nav__link">
    Application lifecycle parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#database-management" class="md-nav__link">
    Database management
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#available-fixtures" class="md-nav__link">
    Available fixtures
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#writing-tests" class="md-nav__link">
    Writing Tests
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-tox" class="md-nav__link">
    Using tox
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="writing-tests-with-pytest">Writing tests with pytest<a class="headerlink" href="#writing-tests-with-pytest" title="Permanent link">&para;</a></h1>
<p>Pokie includes a set of plugins to aid unit testing of applications with <a href="https://pytest.org">pytest</a>, including
a CLI runner. These plugins provide Pokie-related fixtures and, optionally, automatic database management.</p>
<p>To use the pytest integration, it is required to use the application factory to initialize the application, see 
the <a href="../../tutorial/tutorial/#application-factory-build_pokie">tutorial</a> for more details.</p>
<p>Currently, only PostgreSQL is supported for database operations; the configured database user must have database creation/drop privileges;
The plugins also assume the user can connect to the database 'postgres', as it is used as the default db for
administrative operations.</p>
<blockquote>
<p>Note: To use Pokie's unit testing capabilities, you need to install pytest </p>
</blockquote>
<h2 id="pokie-configuration">Pokie Configuration<a class="headerlink" href="#pokie-configuration" title="Permanent link">&para;</a></h2>
<p>There are several test-related configuration parameters available to control execution of tests,
exposed via <strong>pokie.config.TestConfigTemplate</strong>:</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>TEST_DB_NAME</td>
<td>PostgreSQL test database name</td>
</tr>
<tr>
<td>TEST_DB_HOST</td>
<td>PostgreSQL host</td>
</tr>
<tr>
<td>TEST_DB_PORT</td>
<td>PostgreSQL port</td>
</tr>
<tr>
<td>TEST_DB_USER</td>
<td>PostgreSQL user</td>
</tr>
<tr>
<td>TEST_DB_PASSWORD</td>
<td>PostgreSQL password</td>
</tr>
<tr>
<td>TEST_DB_SSL</td>
<td>if True, enforces SSL</td>
</tr>
<tr>
<td>TEST_MANAGE_DB</td>
<td>if False, no db is managed via pytest-pokie</td>
</tr>
<tr>
<td>TEST_SHARE_CTX</td>
<td>if False, create a new application instance between tests (default)</td>
</tr>
<tr>
<td>TEST_DB_REUSE</td>
<td>if False, drops and recreates the database between tests (default)</td>
</tr>
<tr>
<td>TEST_SKIP_MIGRATIONS</td>
<td>if False, runs migrations when creating the database</td>
</tr>
<tr>
<td>TEST_SKIP_FIXTURES</td>
<td>if False, runs fixtures when creating the database</td>
</tr>
</tbody>
</table>
<h3 id="application-lifecycle-parameters">Application lifecycle parameters<a class="headerlink" href="#application-lifecycle-parameters" title="Permanent link">&para;</a></h3>
<p><strong>TEST_SHARE_CTX</strong></p>
<p><strong>False (default)</strong>: Each test is run with a separate application instance; the application is bootstrapped at each
test, by using the existing application factory.</p>
<p><strong>True</strong>: All tests are run with the same pokie FlaskApplication and Flask instance; services, events, etc. will be
managed
and cached as in a production run.</p>
<h3 id="database-management">Database management<a class="headerlink" href="#database-management" title="Permanent link">&para;</a></h3>
<p>Please note: The credentials provided to the test database <strong>must</strong> have enough privileges for the required operations,
such as creating and dropping databases.</p>
<p><strong>TEST_MANAGE_DB</strong></p>
<p><strong>False (default)</strong>: If TEST_MANAGE_DB is False, database management is completely ignored, and available db connection
is the regular
application connection. All database test configurations are ignored. With this mode, it is up to the developer to
ensure a clean state between database runs.</p>
<p><strong>True</strong>: If TEST_MANAGE_DB is True, pytest-pokie will manage the database connection using the available test
credentials.
The global database connection is replaced with the test connection, and fixtures and migrations may be executed between
tests.</p>
<p><strong>TEST_DB_REUSE</strong></p>
<p><strong>False (default)</strong>: if TEST_DB_REUSE is False, pytest-pokie will attempt to drop and recreate the test database between
each test.</p>
<p><strong>True</strong>: if TEST_DB_REUSE is True, pytest-pokie will not drop the testing database if exists. If it doesn't exist, it
will attempt to create the database and optionally run migrations and fixtures, depending on TEST_SKIP_MIGRATIONS and
TEST_SKIP_FIXTURES values.</p>
<p><strong>TEST_SKIP_MIGRATIONS</strong></p>
<p><strong>False (default)</strong>: Existing SQL migrations will be run when the database is recreated.</p>
<p><strong>True</strong>: Existing SQL migrations are ingored, even if the database is recreated.</p>
<p><strong>TEST_SKIP_FIXTURES</strong></p>
<p><strong>False (default)</strong>:Existing fixtures will be run when the database is recreated.</p>
<p><strong>True</strong>: Existing fixtures are ignored, even if the database is recreated.</p>
<h2 id="available-fixtures">Available fixtures<a class="headerlink" href="#available-fixtures" title="Permanent link">&para;</a></h2>
<p>Note: fixtures depend on the predefined values for the different DI constants as specified on the <em>pokie.constants</em>
file.</p>
<table>
<thead>
<tr>
<th>Fixture</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>pokie_app</td>
<td>Pokie Flask object</td>
</tr>
<tr>
<td>pokie_config</td>
<td>Pokie Config object</td>
</tr>
<tr>
<td>pokie_di</td>
<td>Pokie Di object</td>
</tr>
<tr>
<td>pokie_db</td>
<td>Pokie Database client</td>
</tr>
<tr>
<td>pokie_client</td>
<td>Flask test client</td>
</tr>
</tbody>
</table>
<h2 id="writing-tests">Writing Tests<a class="headerlink" href="#writing-tests" title="Permanent link">&para;</a></h2>
<p>Pytest must be invoked using the internal Pokie pytest runner. The pytest runner will automatically add the required
dependencies to pytest. All additional pytest command-line arguments can be specified:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>python<span class="w"> </span>main.py<span class="w"> </span>pytest<span class="w"> </span>--help

<span class="o">[</span>Pokie<span class="o">]</span><span class="w"> </span>Running<span class="w"> </span>pytest<span class="w"> </span>with:<span class="w"> </span><span class="o">[</span><span class="s1">&#39;--help&#39;</span><span class="o">]</span>
usage:<span class="w"> </span>main.py<span class="w"> </span><span class="o">[</span>options<span class="o">]</span><span class="w"> </span><span class="o">[</span>file_or_dir<span class="o">]</span><span class="w"> </span><span class="o">[</span>file_or_dir<span class="o">]</span><span class="w"> </span><span class="o">[</span>...<span class="o">]</span>

positional<span class="w"> </span>arguments:
<span class="w">  </span>file_or_dir

general:
<span class="w">  </span>-k<span class="w"> </span>EXPRESSION<span class="w">         </span>only<span class="w"> </span>run<span class="w"> </span>tests<span class="w"> </span>which<span class="w"> </span>match<span class="w"> </span>the<span class="w"> </span>given<span class="w"> </span>substring<span class="w"> </span>expression.<span class="w"> </span>An<span class="w"> </span>expression<span class="w"> </span>is<span class="w"> </span>a<span class="w"> </span>python<span class="w"> </span>evaluatable<span class="w"> </span>expression<span class="w"> </span>where<span class="w"> </span>all<span class="w"> </span>names<span class="w"> </span>are<span class="w"> </span>substring-matched<span class="w"> </span>against<span class="w"> </span><span class="nb">test</span><span class="w"> </span>names<span class="w"> </span>and<span class="w"> </span>their<span class="w"> </span>parent<span class="w"> </span>classes.<span class="w"> </span>Example:<span class="w"> </span>-k
<span class="w">                        </span><span class="s1">&#39;test_method or test_other&#39;</span><span class="w"> </span>matches<span class="w"> </span>all<span class="w"> </span><span class="nb">test</span><span class="w"> </span>functions<span class="w"> </span>and<span class="w"> </span>classes<span class="w"> </span>whose<span class="w"> </span>name<span class="w"> </span>contains<span class="w"> </span><span class="s1">&#39;test_method&#39;</span><span class="w"> </span>or<span class="w"> </span><span class="s1">&#39;test_other&#39;</span>,<span class="w"> </span><span class="k">while</span><span class="w"> </span>-k<span class="w"> </span><span class="s1">&#39;not test_method&#39;</span><span class="w"> </span>matches<span class="w"> </span>those<span class="w"> </span>that<span class="w"> </span>don<span class="s1">&#39;t contain &#39;</span>test_method<span class="s1">&#39; in their names. -k</span>
<span class="s1">                        &#39;</span>not<span class="w"> </span>test_method<span class="w"> </span>and<span class="w"> </span>not<span class="w"> </span>test_other<span class="s1">&#39; will eliminate the matches. Additionally keywords are matched to classes and functions containing extra names in their &#39;</span>extra_keyword_matches<span class="s1">&#39; set, as well as functions which</span>
<span class="s1">                        have names assigned directly to them. The matching is case-insensitive.</span>
<span class="s1">  -m MARKEXPR           only run tests matching given mark expression.</span>
<span class="s1">                        For example: -m &#39;</span>mark1<span class="w"> </span>and<span class="w"> </span>not<span class="w"> </span>mark2<span class="err">&#39;</span>.
<span class="w">  </span>--markers<span class="w">             </span>show<span class="w"> </span>markers<span class="w"> </span><span class="o">(</span>builtin,<span class="w"> </span>plugin<span class="w"> </span>and<span class="w"> </span>per-project<span class="w"> </span>ones<span class="o">)</span>.
<span class="w">  </span>-x,<span class="w"> </span>--exitfirst<span class="w">       </span><span class="nb">exit</span><span class="w"> </span>instantly<span class="w"> </span>on<span class="w"> </span>first<span class="w"> </span>error<span class="w"> </span>or<span class="w"> </span>failed<span class="w"> </span>test.
<span class="w">  </span>--fixtures,<span class="w"> </span>--funcargs
<span class="o">(</span>...<span class="o">)</span>
$
</code></pre></div>
<p>The scaffold structure is similar to the common pytest usage:</p>
<div class="highlight"><pre><span></span><code>some_module/
<span class="w">  </span><span class="o">(</span>...<span class="o">)</span>
main.py
tests/
<span class="w">  </span>__init__.py
<span class="w">  </span>some_module/
<span class="w">    </span>__init__.py
<span class="w">    </span>test_something.py<span class="w">  </span>
</code></pre></div>
<p>test_something.py:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">test_example_1</span><span class="p">(</span><span class="n">pokie_app</span><span class="p">,</span> <span class="n">pokie_di</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">pokie_app</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
    <span class="k">assert</span> <span class="n">pokie_app</span><span class="o">.</span><span class="n">di</span> <span class="o">==</span> <span class="n">pokie_di</span>


<span class="k">def</span> <span class="nf">test_example_2</span><span class="p">(</span><span class="n">pokie_db</span><span class="p">,</span> <span class="n">pokie_service_manager</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">pokie_db</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
    <span class="k">assert</span> <span class="n">pokie_service_manager</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</code></pre></div>
<p>And to run the tests:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>python3<span class="w"> </span>main.py<span class="w"> </span>pytest
</code></pre></div>
<h2 id="using-tox">Using tox<a class="headerlink" href="#using-tox" title="Permanent link">&para;</a></h2>
<p>Example tox.ini:</p>
<div class="highlight"><pre><span></span><code><span class="k">[tox]</span>
<span class="na">envlist</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="na">py39</span>
<span class="w">    </span><span class="na">py310</span>

<span class="k">[testenv]</span>
<span class="na">deps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">-rrequirements-dev.txt</span>
<span class="na">commands</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">python3 main.py pytest</span>
</code></pre></div>
<p>Example requirements-dev.txt:</p>
<div class="highlight"><pre><span></span><code><span class="nv">pytest</span><span class="o">==</span><span class="m">7</span>.3.1
<span class="nv">pokie</span><span class="o">==</span><span class="m">1</span>.0.0
<span class="nv">tox</span><span class="o">==</span><span class="m">4</span>.5.1
</code></pre></div>
<p>Running tox:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>tox<span class="w"> </span>-e<span class="w"> </span>py310
</code></pre></div>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/oddbit/pokie" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["search.suggest", "search.highlight", "content.tabs.link"], "search": "../../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.dff1b7c8.min.js"></script>
      
    
  </body>
</html>